---
title: "Data_analysis_scratch"
author: "Cora Ferguson"
date: "2022-11-14"
output: html_document
---

# Overview
Given that last time we cleaned up the data to seperate the variables that we are interested in out, now I am moving onto the data analysis phase.  I have three different hypothesis that I want to look at:

  1.	Hypothesis: Since the active prosthetic is designed to mimic the natural motion of the body, I believe the active prosthetic will have more propulsion while walking uphill than the passive prosthetic. 
  
  2.	Hypothesis: When walking downhill, the body absorbs force by dampening each step.  This allows humans to maintain a reasonable center of gravity while reducing the forces on other joints.  The active prosthetic is designed to increase energy return upon stepping up whereas the passive ankle is designed to absorb energy and transfer it forward.  While the energy that is transferred forward may not be as strong as in the active prosthetic, I expect the dampening effect of the passive prosthetic to be greater than the active prosthetic. 
  
  3.	Hypothesis: The next think that I want to look at is the effects of power generation in different parts of the stance on overall swing velocity.  Power generation refers to the amount of force that is used to push off of the ground.  In different stances, different muscles are involved in power generation which causes this force to vary.  I want to see which stance has the greatest impact on overall power generation.  The three stances I will analyze are the pre-swing, the midstance, and the terminal stance.  Of these, I believe that power generation will be the greatest in the midstance phase.
  
Before we get into actually analysing these datasets, we need to set up R so we have the libraries that we need and the environment is cleared.
```{r}
# clear R's environment
rm(list = ls())

# import the modules that we need
library(dplyr)
library(ggplot2)
library(ggfortify)
library(here)
```

Now we are going to import the data that we processed during the data exploration phase:
```{r}
DF <- read.csv(here("Data", "Processed", "processed_prosthetic_analysis.csv"))
```

# Data Analysis
Since the data is now in the program, we are going to start taking a look at the data analysis I want to perform.

## Comparing Propulsion between Prosthetic Types
For this test I would like to compare how the propulsion generated by the active prosthetic compares to the propulsion generated by the passive prosthetic. From the data exploration, it appears that there is a difference in the spread of the distribution between the two different types of prosthetic and the magnitude of the propulsion that they are able to generate.  

```{r}
# make a histogram of the Power_Gen_Terminal based on prosthetic type
ggplot(filter(DF, Side == "Prosthetic"), aes(x = Power_Gen_Terminal))+
    geom_histogram(binwidth = 0.25)+
    facet_wrap(~Session)
```

To do this, I will perform a two sample T test between the two prosthetic types.  

```{r}
# perform two sample t test
t.test(Propulsion ~ filter(DF, Side == "Prosthetic"), data = DF)
```
Yep, that did not work.  I first need to filter out the prosthetic data from the rest of the data.  To do that, I will use piping to create a new DF to use.
```{r}
# separate the prosthetic data from the data corresponding to the intact leg data.
DF_prosthetic <- DF %>% filter(Side == "Prosthetic")

# take a look to check this new data frame
glimpse(DF_prosthetic)
```
Ok now lets give the two sample t test another shot:
```{r}
# perform two sample t test
t.test(Propulsion ~ Session, data = DF_prosthetic)
```
Based on this, there is not a significant difference between the propulsion generated by the active and passive prostheses. Let's graph this in a way that models this relationship better.  I think a scatter plot might show it best.
```{r}
# make a scatter plot comparing the distribution of propulsion values between the active and passive prostheses
ggplot(DF_prosthetic, aes(Session, Propulsion, colour = Session))+
     xlab("Type of Prosthetic")+
     ylab("Propulsion (J/Kg)")+
     geom_jitter()+
     theme_bw()+
     theme(legend.position="none")
```

Great! Now we are going to move onto the next hypothesis.  Here we are trying to figure out how to compare the dampening effects of each of the different types of prostheses compared to the intact leg. 

## Comparing Dampening Between Prosthetic Types and The Intact Leg
To make this comparison, I am going to perform a two-way ANOVA. The goal is to compare the dampening performance between prostheses and intact legs and see if the type of prosthetic has an effect on dampening performance.

In this case, two of our variables are categorical - type of leg and type of prosthetic.  First let's convert these from factor to character data:

```{r}
# convert the Session and the Side categories to factor data and take a look at the variables
DF$Session <- as.factor(DF$Session)
DF$Side <- as.factor(DF$Side)

levels(DF$Session)
levels(DF$Side)
```

Now, lets take a look at the means of the combinations of each of these.  To do this, we will be using the `group_by()` and `summarize()` functions. 

```{r}
meanDF <- DF %>% group_by(Side, Session) %>% summarise(meanDampening = mean(Braking))
```
Now, we are going to plot the relationship between these different variables using the means of different combinations. 

```{r}
# create a scatter plot that is modeling the relationship between these
ggplot(meanDF, aes(Side, meanDampening))+
     geom_point()+
     theme_bw()

```
This graph does not tell us a whole lot so lets beef up the plot a little bit to make the differences and the relationships between them a little clearer. 

```{r}
# Add color to the plot to show the differences between the different types of prostheses compared to the intact leg
ggplot(meanDF, aes(Side, meanDampening, color = Session, group = Session))+
     geom_point()+
     geom_line()+
     theme_bw()
```
2 - way analysis of variance (chapter 6).  ANOVA (glm(damp~side+session+ side*session))

3. Repeated measures analysis of variance - convert data from wide to long to look at phase and power generation
